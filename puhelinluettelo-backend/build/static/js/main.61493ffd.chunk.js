(this.webpackJsonppuhelinluettelo=this.webpackJsonppuhelinluettelo||[]).push([[0],{39:function(e,n,t){},41:function(e,n,t){"use strict";t.r(n);var o=t(16),c=t.n(o),r=t(3),u=t(2),a=t(4),i=t.n(a),l="/api/persons",s=function(){return i.a.get(l).then((function(e){return e.data}))},d=function(e){return i.a.post(l,e).then((function(e){return e.data}))},f=function(e,n){return i.a.put("".concat(l,"/").concat(e),n).then((function(e){return e.data}))},j=function(e){return i.a.delete("".concat(l,"/").concat(e)).then((function(e){return e.data}))},b=(t(39),t(0)),h=function(e){var n=e.handler;return Object(b.jsx)("button",{onClick:n,children:"delete"})},m=function(e){var n=e.person,t=e.delHandler;return Object(b.jsxs)("li",{children:[n.name," ",n.phone," ",Object(b.jsx)(h,{handler:t})," "]})},O=function(e){var n=e.inputlabel,t=e.inputvalue,o=e.handler;return Object(b.jsxs)("div",{children:[n,": ",Object(b.jsx)("input",{value:t,onChange:o})]})},p=function(e){var n=e.submitfunction,t=e.newName,o=e.newPhone,c=e.handleNameChange,r=e.handleNewNumberChange;return Object(b.jsxs)("form",{onSubmit:n,children:[Object(b.jsx)(O,{inputlabel:"name",inputvalue:t,handler:c}),Object(b.jsx)(O,{inputlabel:"number",inputvalue:o,handler:r}),Object(b.jsx)("div",{children:Object(b.jsx)("button",{type:"submit",children:"add"})})]})},g=function(e){var n=e.personsFiltered,t=e.delPerson;return Object(b.jsx)("ul",{children:n.map((function(e){return Object(b.jsx)(m,{person:e,delHandler:function(){return t(e)}},e.id)}))})},v=function(e){var n=e.message;return null===n?null:Object(b.jsx)("div",{className:"notification",children:n})},x=function(e){var n=e.message;return null===n?null:Object(b.jsx)("div",{className:"error",children:n})},w=function(){var e=Object(u.useState)([]),n=Object(r.a)(e,2),t=n[0],o=n[1],c=Object(u.useState)(""),a=Object(r.a)(c,2),i=a[0],l=a[1],h=Object(u.useState)(""),m=Object(r.a)(h,2),w=m[0],N=m[1],y=Object(u.useState)(""),C=Object(r.a)(y,2),S=C[0],P=C[1],T=Object(u.useState)(""),k=Object(r.a)(T,2),L=k[0],E=k[1],F=Object(u.useState)(""),J=Object(r.a)(F,2),D=J[0],H=J[1],B=Object(u.useState)(t),I=Object(r.a)(B,2),q=I[0],z=I[1];Object(u.useEffect)((function(){console.log("effect"),setTimeout((function(){E(null),H(null)}),1),s().then((function(e){console.log("promise fulfilled"),o(e),z(e)})).catch((function(e){console.log("fail on getting Persons from db")}))}),[]),console.log("render",t.length,"persons");return Object(b.jsxs)("div",{children:[Object(b.jsx)("h2",{children:"Phonebook"}),Object(b.jsx)(v,{message:L}),Object(b.jsx)(x,{message:D}),Object(b.jsx)(O,{inputlabel:"Filter numbers:",inputvalue:S,handler:function(e){P(e.target.value);var n=t.filter((function(e){return e.name.toLowerCase().match(S.toLowerCase())}));e.target.value.length>0?(console.log("show filtered"),z(n)):(console.log("show persons"),z(t))}}),Object(b.jsx)("h2",{children:"add New"}),Object(b.jsx)(p,{submitfunction:function(e){e.preventDefault();var n={name:i,phone:w},c=t.find((function(e){return e.name.toLowerCase()===n.name.toLowerCase()}));c?(console.log("Exist!"),window.confirm("".concat(i," is already added to phonebook, replace old number with a new one?"))&&f(c.id,n).then((function(e){o(t.map((function(n){return n.id!==e.id?n:e}))),z(t.map((function(n){return n.id!==e.id?n:e}))),E("Number of '".concat(e.name,"' was succesfully edited")),setTimeout((function(){E(null)}),3e3)})).catch((function(e){o(t.filter((function(e){return e.id!==c.id}))),z(t.filter((function(e){return e.id!==c.id}))),console.log(e),H("Note '".concat(c.name,"' was already removed from server")),setTimeout((function(){H(null)}),3e3)}))):d(n).then((function(e){o(t.concat(e)),l(""),N(" "),z(t.concat(e)),E("Contact '".concat(e.name,"' was succesfully created")),setTimeout((function(){E(null)}),3e3)})).catch((function(e){console.log(e.response.data),H(JSON.stringify(e.response.data)),setTimeout((function(){H(null)}),3e3)}))},newName:i,newPhone:w,handleNameChange:function(e){l(e.target.value)},handleNewNumberChange:function(e){N(e.target.value)}}),Object(b.jsx)("h2",{children:"Numbers"}),Object(b.jsx)(g,{personsFiltered:q,delPerson:function(e){window.confirm("Doyou really want to delete ".concat(e.name,"?"))&&(console.log("log: deleting ".concat(e.id)),j(e.id).then((function(){o(t.filter((function(n){return n.id!==e.id}))),z(t.filter((function(n){return n.id!==e.id}))),E("Person '".concat(e.name,"' was succesfully removed from server")),setTimeout((function(){E(null)}),3e3)})).catch((function(n){console.log(n),console.log("maybe failed to delete ".concat(e.id))})))}}),"---",Object(b.jsxs)("div",{children:["debug: ",i]}),Object(b.jsxs)("div",{children:["debug Phone: ",w]}),Object(b.jsxs)("div",{children:["debug filer text: ",S]})]})};c.a.render(Object(b.jsx)(w,{}),document.getElementById("root"))}},[[41,1,2]]]);
//# sourceMappingURL=main.61493ffd.chunk.js.map